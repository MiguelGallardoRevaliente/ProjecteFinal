<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="css/style.css">
    <link rel="stylesheet" href="css/basic.css">
    <link href='https://unpkg.com/boxicons@2.1.4/css/boxicons.min.css' rel='stylesheet'>
    <title>Chamous</title>
    <script type="module">
        const form = document.querySelector('form');
        const login = document.getElementById('login');

        login.addEventListener('click', async () => {
            fetch('/login', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify({
                    username: document.getElementById('username').value,
                    password: document.getElementById('password').value
                })
            })
                .then(response => {
                    if (response.ok) {
                        window.location.href = '/intro'
                    } else if (response.status === 401) {
                        alert('User or password incorrects')
                    }
                })
                .catch(error => {
                    console.error('Error', error)
                });
        })

        form.addEventListener('submit', (e) => {
            e.preventDefault();
        });
    </script>
</head>
<body>
    <div id="fullscreenIcon" class="icon">
        <i class='bx bx-fullscreen'></i>
        <i class='bx bx-exit-fullscreen'></i>
    </div>
    <div class="container" id="divLogin">
        <h1>Start session and travel to Chamous</h1>
        <p>Log In and Continue your adventure</p>
        <form class="form">
            <input type="text" name="username" id="username" placeholder="Username">
            <input type="password" name="password" id="password" placeholder="Password">
            <button type="submit" id="login" onclick="logIn()">Log In</button>
            <button type="submit" class="register" onclick="showRegister()">Register</button>
            <button type="submit"  onclick="showforgot()" id="bfpassword">Forgot your password?</button>
        </form>
    </div>

    <div class="container" id="register">
        <h1>Register</h1>
        <p>Register and start your adventure</p>
        <form class="form">
            <input type="text" name="name" id="name" placeholder="Name" required>
            <input type="text" name="surname" id="surname" placeholder="surname" required>
            <input type="text" name="email" id="email" placeholder="email" required>
            <input type="text" name="usernameR" id="usernameR" placeholder="Username" required>
            <input type="password" name="passwordR" id="passwordR" placeholder="Password" required>
            <input type="password" name="rpasswordR" id="rpasswordR" placeholder="Repeat Password" required>
            <button type="submit" id="register-button">Register</button>
        </form>
    </div>


    <div class="container" id="forgot">
        <h1>Forgot your password?</h1>
        <p>Enter your new Password</p>
        <form class="form">
            <input type="password" name="newPassword" id="newPassword" placeholder="Password" required>
            <input type="password" name="newPasswordR" id="newPasswordR" placeholder="Repeat Password" required>
            <button type="submit" id="change-password">Change Password</button>
        </form>


    <script src="js/index.js"></script>

</body>
</html>