<!DOCTYPE html>
<html>
<head>
    <meta charset='utf-8'>
    <meta http-equiv='X-UA-Compatible' content='IE=edge'>
    <title>Home - Chamous</title>
    <meta name='viewport' content='width=device-width, initial-scale=1'>
    <link rel='stylesheet' type='text/css' media='screen' href='css/game.css'>
    <link href='https://unpkg.com/boxicons@2.1.4/css/boxicons.min.css' rel='stylesheet'>
    <script type='module'>
        const inventory = localStorage.getItem('inventory') || 'cards'
        inventoryLink.href = `/${inventory}`
        const username = localStorage.getItem('username')
        
        if (!username) {
            window.location.href = '/login'
        }

        window.onload = () => {
            const shopcards = document.getElementById('shop_cards')
            const shopchests = document.getElementById('shop_chests')
            shopchests.style.boxShadow = '1px 1px 5px black inset'
            shopcards.style.boxShadow = '1px 1px 5px black'
            shopcards.style.backgroundColor = 'gray'
            shopchests.style.backgroundColor = '#292929'

            const shopCardsBody = document.getElementsByClassName('shop_cards_body')[0]

            fetch(`/getShopCards?id=${localStorage.getItem('id')}`, {
                method: 'GET'
            })
                .then(res => res.json())
                .then(data => {
                    console.log(data)
                    data.forEach(card => {
                        const tr = document.createElement('tr')
                        tr.setAttribute('onclick', `buyCard(${card.carta.id}, ${card.precio}, '${card.carta.nombre}')`)
                        const img = document.createElement('img')
                        img.src = card.carta.foto
                        img.style.width = '30px'
                        tr.appendChild(img)
                        const name = document.createElement('td')
                        name.innerText = card.carta.nombre
                        tr.appendChild(name)
                        const type = document.createElement('td')
                        type.innerText = card.carta.tipo
                        tr.appendChild(type)
                        const rank = document.createElement('td')
                        if (card.carta.rareza === 5) {
                            rank.innerText = 'R'
                        } else if (card.carta.rareza === 4) {
                            rank.innerText = 'EXT'
                        } else if (card.carta.rareza === 3) {
                            rank.innerText = 'EXC'
                        } else if (card.carta.rareza === 2) {
                            rank.innerText = 'ESP'
                        } else if (card.carta.rareza === 1) {
                            rank.innerText = 'C'
                        }
                        tr.appendChild(rank)
                        const price = document.createElement('td')
                        price.innerText = card.precio
                        tr.appendChild(price)
                        shopCardsBody.appendChild(tr)
                    })
                })
        }

        const form = document.getElementsByClassName('form')[0]

        form.addEventListener('submit', (e) => {
            e.preventDefault()
            const name = document.getElementById('name').value
            const quality = document.getElementById('quality').value
            const type = document.getElementById('type').value
            console.log(name)
            console.log(quality)
            console.log(type)
        })
    </script>
</head>
<body>
    <header>
        <div class="logo">
            <img src="img/logoC.png" alt="">
            <h1>CHAMOUS</h1>
        </div>
        <nav>
            <ul>
                <a href="/">HOME</a>
                <a href="/cards" id="inventoryLink">INVENTORY</a>
                <a href="/shop">SHOP</a>
                <a href="/information">INFORMATION</a>
            </ul>
        </nav>
        <div class="config" onclick="window.location.href='/settings'">
            <a href="/settings">
            <i class='bx bx-cog'></i>
            <p>SETTINGS</p>
            </a>
        </div>
    </header>
    <div id="shop">
        <div class="container">
            <div class="top">
                <h1>SHOP</h1>
                <button onclick="mostrarShopCards()" id="shop_cards"><i class='bx bxs-memory-card'></i></button>
                <button onclick="mostrarShopChests()" id="shop_chests"><i class='bx bxs-box'></i></button>
            </div>
            <div id="allcards" class="all">
                <div class="filtrer">
                    <form action="" class="form">
                        <label for="search">Search</label>
                        <input type="text" name="name" id="name">

                        <label for="quality">Quality</label>
                        <select name="quality" id="quality">
                            <option value="none">--</option>
                            <option value="5">R</option>
                            <option value="4">EXT</option>
                            <option value="3">EXC</option>
                            <option value="2">ESP</option>
                            <option value="1">C</option>
                        </select>

                        <label for="type">Type</label>
                        <select name="type" id="type">
                            <option value="none">--</option>
                            <option value="Wind">Wind</option>
                            <option value="Poison">Poison</option>
                            <option value="Rocks">Rocks</option>
                            <option value="Dark">Dark</option>
                            <option value="Neutral">Neutral</option>
                            <option value="Light">Light</option>
                            <option value="Fire">Fire</option>
                            <option value="Forest">Forest</option>
                            <option value="Water">Water</option>
                        </select>
                        <button type="submit" id="search"><i class='bx bx-search'></i></button>
                    </form>
                </div>
                <div class="shop_cards">
                    <table>
                        <thead>
                            <tr>
                                <th></th>
                                <th></th>
                                <th>Type</th>
                                <th>Rank</th>
                                <th>Price</th>
                            </tr>
                        </thead>
                        <tbody class="shop_cards_body">
                        </tbody>
                    </table>
                </div>
                <div class="confirmar_compra_carta">
                    <h2 class="nombre_carta_confirmar"></h2>
                    <form action="" class="form_compra_carta">
                    </form>
                    <button onclick="cancelarCompraCarta()">CANCEL</button>
                </div>
            </div>
            <div id="allchests" class="all">

            </div>
        </div>
    </div>
    <audio id="audio" src="img/MÃºsica para la Tierra Media (sin copyright).mp3" autoplay loop></audio> 
    <script src="js/game.js"></script>
</body>
</html>