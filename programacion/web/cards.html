<!DOCTYPE html>
<html>

<head>
    <meta charset='utf-8'>
    <meta http-equiv='X-UA-Compatible' content='IE=edge'>
    <title>Home - Chamous</title>
    <meta name='viewport' content='width=device-width, initial-scale=1'>
    <link rel='stylesheet' type='text/css' media='screen' href='css/game.css'>
    <link href='https://unpkg.com/boxicons@2.1.4/css/boxicons.min.css' rel='stylesheet'>
    <script type='module'>
        localStorage.setItem('inventory', 'cards')
        const username = localStorage.getItem('username')

        if (!username) {
            window.location.href = '/login'
        }

        window.onload = () => {
            const yourCards = document.getElementsByClassName('yourCards')[0]
            yourCards.innerHTML = ''
            const id = localStorage.getItem('id')
            fetch(`http://13.53.190.234/getCards?id=${id}`, {
                method: 'GET'
            })
                .then(response => response.json())
                .then(data => {
                    console.log(data)
                    const length = data.filteredCards.length
                    for (let i = 0; i < length; i++) {
                        const card = data.filteredCards[i]

                        const cardDiv = document.createElement('div')
                        cardDiv.className = 'carta'
                        cardDiv.style.backgroundImage = `url(${card.foto})`

                        const nombreCarta = document.createElement('p')
                        nombreCarta.className = 'nombreCarta'
                        nombreCarta.innerHTML = card.nombre

                        const ataqueVida = document.createElement('p')
                        ataqueVida.className = 'ataque-vida'
                        ataqueVida.innerHTML = card.ataque + '/' + card.vida

                        const ataqueEspecial = document.createElement('p')
                        ataqueEspecial.className = 'ataque-especial'
                        const textoAtaqueEspecial = data.ataques[i][0].nombre + ' - ' + data.ataques[i][0].descripcion
                        ataqueEspecial.innerHTML = textoAtaqueEspecial

                        cardDiv.appendChild(nombreCarta)
                        cardDiv.appendChild(ataqueEspecial)
                        cardDiv.appendChild(ataqueVida)
                        yourCards.appendChild(cardDiv)
                    }
                })
        }

        const quality = document.getElementById('quality')

        quality.addEventListener('change', () => {
            const yourCards = document.getElementsByClassName('yourCards')[0]
            yourCards.innerHTML = ''
            let ordenType = quality.value
            let orden = 'DESC'
            if (ordenType !== 'rareza' && ordenType !== 'tipo') {
                ordenType = 'costo_mana'
            }

            if (quality.value === 'manaDown') {
                orden = 'ASC'
            }
            const id = localStorage.getItem('id')
            fetch(`http://13.53.190.234/getCards?id=${id}&ordenType=${ordenType}&orden=${orden}`, {
                method: 'GET'
            })
                .then(response => response.json())
                .then(data => {
                    console.log(data)
                    const length = data.filteredCards.length
                    for (let i = 0; i < length; i++) {
                        const card = data.filteredCards[i]

                        const cardDiv = document.createElement('div')
                        cardDiv.className = 'carta'
                        cardDiv.style.backgroundImage = `url(${card.foto})`

                        const nombreCarta = document.createElement('p')
                        nombreCarta.className = 'nombreCarta'
                        nombreCarta.innerHTML = card.nombre

                        const ataqueVida = document.createElement('p')
                        ataqueVida.className = 'ataque-vida'
                        ataqueVida.innerHTML = card.ataque + '/' + card.vida

                        const ataqueEspecial = document.createElement('p')
                        ataqueEspecial.className = 'ataque-especial'
                        const textoAtaqueEspecial = data.ataques[i][0].nombre + ' - ' + data.ataques[i][0].descripcion
                        ataqueEspecial.innerHTML = textoAtaqueEspecial

                        cardDiv.appendChild(nombreCarta)
                        cardDiv.appendChild(ataqueEspecial)
                        cardDiv.appendChild(ataqueVida)
                        yourCards.appendChild(cardDiv)
                    }
                })
        })
    </script>
</head>

<body>
    <header>
        <div class="logo">
            <img src="img/logoC.png" alt="">
            <h1>CHAMOUS</h1>
        </div>
        <nav>
            <ul>
                <a href="/">HOME</a>
                <a href="/cards">INVENTORY</a>
                <a href="/shop">SHOP</a>
                <a href="/information">INFORMATION</a>
            </ul>
        </nav>
        <div class="config">
            <i class='bx bx-cog'></i>
            <a href="/settings">SETTINGS</a>
        </div>
    </header>
    <div id="inventory">
        <div class="container">
            <div class="links">
                <div id="especial-link" onclick="window.location.reload()"><button><svg height="200px" width="200px" version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 512 512" xml:space="preserve" fill="#000000"><g id="SVGRepo_bgCarrier" stroke-width="0"></g><g id="SVGRepo_tracerCarrier" stroke-linecap="round" stroke-linejoin="round"></g><g id="SVGRepo_iconCarrier"> <path style="fill:#ffffff;" d="M380.854,504H131.146C116.706,504,105,492.294,105,477.854V34.146C105,19.706,116.706,8,131.146,8 h249.707C395.294,8,407,19.706,407,34.146v443.707C407,492.294,395.294,504,380.854,504z"></path> <g> <path style="fill:#ffffff;" d="M376,0H136c-22.056,0-40,17.944-40,40v432c0,22.056,17.944,40,40,40h240c22.056,0,40-17.944,40-40 V40C416,17.944,398.056,0,376,0z M400,472c0,13.233-10.766,24-24,24H136c-13.234,0-24-10.767-24-24V40c0-13.233,10.766-24,24-24 h240c13.234,0,24,10.767,24,24V472z"></path> <path style="fill:#ffffff;" d="M376,87.998V48c0-4.418-3.582-8-8-8h-39.998c-0.001,0-0.003,0-0.005,0h-39.995 c-0.001,0-0.003,0-0.005,0h-39.995c-0.001,0-0.003,0-0.005,0H144c-4.418,0-8,3.582-8,8v15.998c0,0.001,0,0.003,0,0.005v39.995 c0,0.001,0,0.003,0,0.005v39.995c0,0.001,0,0.003,0,0.005v39.995c0,0.001,0,0.003,0,0.005v39.995c0,0.001,0,0.003,0,0.005v39.995 c0,0.001,0,0.003,0,0.005v39.995c0,0.001,0,0.003,0,0.005v39.995c0,0.001,0,0.003,0,0.005v39.995c0,0.001,0,0.003,0,0.005v39.995 c0,0.001,0,0.003,0,0.005V464c0,4.418,3.582,8,8,8h224c4.418,0,8-3.582,8-8v-15.998c0-0.001,0-0.003,0-0.005v-39.995 c0-0.001,0-0.003,0-0.005v-39.995c0-0.001,0-0.003,0-0.005v-39.995c0-0.001,0-0.003,0-0.005v-39.995c0-0.001,0-0.003,0-0.005 v-39.995c0-0.001,0-0.003,0-0.005v-39.995c0-0.001,0-0.003,0-0.005v-39.995c0-0.001,0-0.003,0-0.005v-39.995 c0-0.001,0-0.003,0-0.005V88.002C376,88.001,376,87.999,376,87.998z M307.313,456L152,300.687v-17.373L324.687,456H307.313z M267.313,456L152,340.687v-17.373L284.687,456H267.313z M227.313,456L152,380.687v-17.373L244.687,456H227.313z M187.313,456 L152,420.687v-17.373L204.687,456H187.313z M152,203.313l208,208v17.373l-208-208V203.313z M152,180.687v-17.373l208,208v17.373 L152,180.687z M152,140.687v-17.373l208,208v17.373L152,140.687z M152,100.687V83.313l208,208v17.373L152,100.687z M204.687,56 L360,211.313v17.373L187.313,56H204.687z M227.313,56h17.373L360,171.313v17.373L227.313,56z M267.313,56h17.373L360,131.313 v17.373L267.313,56z M307.313,56h17.373L360,91.313v17.373L307.313,56z M360,68.687L347.313,56H360V68.687z M164.687,56 L360,251.313v17.373l-208-208V56H164.687z M152,443.313L164.687,456H152V443.313z M347.313,456L152,260.687v-17.373l208,208V456 H347.313z"></path> </g> </g></svg></i></button></div>
                <div onclick="window.location.href='/decks'"><button><i class='bx bxs-box'></i></button></div>
                <div onclick="window.location.href='/packs'"><button><i class='bx bxs-box'></i></button></div>
            </div>
            <div class="top">
                <h1>INVENTORY</h1>
            </div>
            <div class="allcards">
                <div class="filtrer">
                    <span>Order By</span>
                    <form action="" class="form">
                        <select name="quality" id="quality">
                            <option value="tipo">Type</option>
                            <option value="rareza">Quality</option>
                            <option value="manaUp">Mayor Maná</option>
                            <option value="manaDown">Menor Maná</option>
                        </select>
                    </form>
                </div>
                <div class="yourCards">
                </div>
            </div>
        </div>
    </div>
    <audio id="audio" src="img/Música para la Tierra Media (sin copyright).mp3" autoplay loop></audio>
    <script src="js/game.js"></script>
</body>
</html>