<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Battle - Chamous</title>
    <link rel="stylesheet" href="css/combat.css">
    <script type="module">
        import { io } from 'https://cdn.socket.io/4.3.2/socket.io.esm.min.js'

        const username = localStorage.getItem('username')

        if (!username && !localStorage.getItem('password')) {
            window.location.href = '/login'
        } else if (username && localStorage.getItem('password')) {
            fetch(`/checkUser?username=${username}&password=${localStorage.getItem('password')}`)
                .then(response => response.json())
                .then(data => {
                    if (data.message !== 'userExists') {
                        localStorage.removeItem('username')
                        localStorage.removeItem('password')
                        localStorage.removeItem('id')
                        window.location.href = '/login'
                    }
                })
        }

        window.onload = () => {
            fetch(`getCardsBattle?id=${localStorage.getItem('id')}`)
                .then(response => response.json())
                .then(data => {
                    console.log(data)
                    data.forEach(card => {
                        const cardElement = document.createElement('div')
                        cardElement.classList.add('card')
                        cardElement.innerHTML = `
                            <img src="${card.image}" alt="${card.name}">
                            <h3>${card.name}</h3>
                            <p>${card.description}</p>
                            <button onclick="selectCard('${card.id}')">Select</button>
                        `
                        document.body.appendChild(cardElement)
                    })
                })
        }
    </script>
</head>
<body>
    <div class="board">

    </div>

    <div class="cards">
        <div class="user"></div>
        
        <div class="yourCards"></div>

    </div>
</body>
</html>